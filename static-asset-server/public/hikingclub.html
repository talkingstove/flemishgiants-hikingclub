<html>
  <head>
    <title>Hiking Club</title>

    <link rel='stylesheet' href='http://localhost:6001/stylesheets/hikingclub.css' />
    <link rel='stylesheet' href='http://localhost:4000/stylesheets/lagomorph/styles.css' />
    <script src="http://localhost:6001/store.js"></script>  

    <script src="https://unpkg.com/dexie@latest/dist/dexie.js"></script>
    <script src="http://localhost:4000/js/lib/lagomorph/L.js"></script>  


    <script src="http://localhost:6001/userDefinedComponents.js"></script>  
  </head>
  <body>
    <script>

    // var db = new Dexie("i8n_database");
    //       db.version(1).stores({
    //           i18n: 'key,value'
    //       });

    //       db.i18n.put({key: "key1", value: "This is a test string"});
          
          var db = new Dexie("hiking_club_i8n_database_2");
          var culture = store.get('activeUser').language;
          var tableName = 'i18n_' + culture;
          var stores = {}; //stores = tables
          stores[tableName] = 'key,value';
          stores.latestUpdate = 'timestamp';


          db.version(2).stores(stores);
          db[tableName].put({key: "key1", value: "This is a test string for hiking"});
          db.latestUpdate.put({timestamp: ""});

      </script>


    <script language="javascript">
      var hasServiceworker = (navigator && navigator.serviceWorker);

      if (hasServiceworker) { //should work chrome, FF, some others... http://caniuse.com/#feat=serviceworkers
        // navigator.serviceWorker.register('lagomorph-sample-service-worker2.js');

        //if qstring cachename, do stuff
      }

      var i18nIP = 'http://10.5.90.59:5000';
      var now = new Date();
      var formattedNow = now.getUTCFullYear() + '-' + (now.getUTCMonth()+1) + '-' + now.getUTCDay() + 'T' + now.getUTCHours() + ':' + now.getUTCMinutes() + ':' + now.getUTCSeconds() + '.' + now.getUTCMilliseconds();

      //"2017-09-10T21:32:00.27"

      $(function() {
        var culture = store.get('activeUser').language;

        if (!culture) {
          console.error('No language specified for current user!');
        }

        L.initialize({
          services: [
            {
              url: 'http://localhost:7001/ajax/site-config.json'
              //cache/offline behavior can go here
            },
            {
              url:  i18nIP + '/api/Translations/culture/' + culture + '/' + formattedNow
            }
          ],
          userDefinedComponents: userDefinedComponents,
          callback: function() {
            alert('hello');
          }      
        });

        
      });
    </script>
    <h1>This is hiking club</h1>


    <div id="page-wrapper">
    </div>
  </body>
</html>